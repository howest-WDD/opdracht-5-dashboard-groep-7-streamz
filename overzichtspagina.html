<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Overzichtspagina - film/serie</title>

    <link rel="stylesheet" href="dist/styles.css">
<!-- 
    <script src="dist/main.js"></script> -->
    <script src="node_modules/jquery/dist/jquery.min.js"></script>

</head>
<body class="js-page-table">
    <section class="c-gebruikers">
        <div class="c-table__header">
          <div class="c-table__filters">
          <input type="text" placeholder="Snel zoeken..." id="search-input" class="c-search">   
          <select name="show-limit-items" id="show-limit-items" class="c-dropdown c-dropdown--mrg c-dropdown--show " onChange = "showItems(this)">
            <option selected class="c-dropdown__option" value="show5">Toon: 5</option>
            <option class="c-dropdown__option" value="show15">Toon: 15</option>
            <option class="c-dropdown__option" value="show30">Toon: 30</option>
            <option class="c-dropdown__option" value="show45">Toon: 45</option>
            <option class="c-dropdown__option" value="show45">Toon: 60</option>
          </select>

            <!-- <div class="c-pagination">
              <a href="#" class="c-pagination__link">&laquo;</a>
              <a href="#" class="c-pagination__link c-pagination__link--active">1</a>
              <a href="#" class="c-pagination__link">2</a>
              <a href="#" class="c-pagination__link">3</a>
              <a href="#" class="c-pagination__link">&raquo;</a>
            </div> -->
          </div>
        </div>
        <table class="c-table js-table">
            <thead class="c-table__head">
            <tr>
            <th class="c-table__head--id" id="table-head-id" data-column="id" data-order="desc">ID &#9650</th>
            <th class="c-table__head--foto"></th>
            <th class="c-table__head--naam" id="table-head-naam" data-column="title" data-order="desc">Title &#9650</th>
            <th class="c-table__head--email" id="table-head-cat" data-column="title" data-order="desc">Categorie &#9650</th>
            <th class="c-table__head--type">Published</th>
            <th class="c-table__head--gebdat">Language</th>
            </tr>
            </thead>
            <tbody class="c-table__body" id="js-tableproduct__body">
            </tbody>
            </table>

            
      </section>

<script>
var myArray = []

$("#js-tableproduct__body > tr.filtered:lt(10)").show();

$('#sort').on('change', function() {
  var value = $(this).val();
  alert(value);
});

$('#search-input').on('keyup', function() {
  var value = $(this).val()
  //console.log(value)
  var data = searchTable(value, myArray)
  buildTable(data)
})

$('#table-head-id').on('click', function(){
  var column = $(this).data('column')
  var order = $(this).data('order')
  //console.log('was clicked', column, order)
  var text = $(this).html()
  text = text.substring(0, text.length - 1);

  if(order == 'desc') {
    myArray = myArray.sort((a,b) => a[column] > b[column] ? 1 : -1)
    $(this).data('order', "asc")
    text += '&#9660'
  } else {
    myArray = myArray.sort((a,b) => a[column] < b[column] ? 1 : -1)
    $(this).data('order', "desc")
    text += '&#9650'
  }
  $(this).html(text)
  buildTable(myArray)

})

$('#table-head-naam').on('click', function(){
  var column = $(this).data('column')
  var order = $(this).data('order')
  //console.log('was clicked', column, order)
  var text = $(this).html()
  text = text.substring(0, text.length - 1);

  if(order == 'desc') {
    myArray = myArray.sort((a,b) => a[column] > b[column] ? 1 : -1)
    $(this).data('order', "asc")
    text += '&#9660'
  } else {
    myArray = myArray.sort((a,b) => a[column] < b[column] ? 1 : -1)
    $(this).data('order', "desc")
    text += '&#9650'
  }
  $(this).html(text)
  buildTable(myArray)

})

$('#table-head-cat').on('click', function(){
  var column = $(this).data('column')
  var order = $(this).data('order')
  //console.log('was clicked', column, order)
  var text = $(this).html()
  text = text.substring(0, text.length - 1);

  if(order == 'desc') {
    myArray = myArray.sort((a,b) => a[column] > b[column] ? 1 : -1)
    $(this).data('order', "asc")
    text += '&#9660'
  } else {
    myArray = myArray.sort((a,b) => a[column] < b[column] ? 1 : -1)
    $(this).data('order', "desc")
    text += '&#9650'
  }
  $(this).html(text)
  buildTable(myArray)

})

buildTable(myArray)

function searchTable(value, data) {
  var filteredData = []

  for (var i = 0; i < data.length; i++){
    value = value.toLowerCase()
    var title = data[i].title.toLowerCase()
    
    if (title.includes(value)) {
      filteredData.push(data[i])
    }
  }

  return filteredData
}

$.ajax({
  method: 'GET',
  url: 'json/products.json',
  success: function(response) {
    myArray = response.products
    buildTable(myArray)
    //console.log(myArray)
  }
})

function buildTable(data) {
  var table = document.getElementById('js-tableproduct__body')

  table.innerHTML = ''

  for (var i = 0; i < data.length; i++) {
    var row = `<tr class="js-table__body--row">
        <td>#${data[i].id}</td>
        <td><img src="${data[i].image}" alt="${data[i].title}"></td>
        <td>${data[i].title}</td>
        <td>${data[i].type}, ${data[i].categorie}</td>
        <td>${data[i].status}</td>
        <td>${data[i].language}</td>
      </tr>`

      table.innerHTML += row
  }
}

$(function () {
    var numShown = 5; // Initial rows shown & index
    var numMore = 10;  // Increment

    var $table = $('table').find('tbody');  // tbody containing all the rows
    var numRows = $table.find('tr').length; // Total # rows
    // Hide rows and add clickable div
    $table.find('tr:gt(' + (numShown - 1) + ')').hide().end()
        .after('<tbody id="more"><tr><td colspan="' +
               $table.find('tr:first td').length + '</tbody></td></tr>');

    $('#show-limit-items').on('change', function() {
        numShown = numShown + numMore;

        // change rows remaining if less than increment
        if (numRows - numShown < numMore) {
            $('#more span').html(numRows - numShown);
        }
        $table.find('tr:lt(' + numShown + ')').show();
    })

})

</script>
</body>
</html>